CREATE TABLE IF NOT EXISTS DEPARTMENT (
    EMPLOYEE_ID TEXT,
    NAME TEXT,
    DEPARTMENT_ID TEXT,
    MANAGER_ID TEXT,
    SALARY REAL
);

INSERT INTO DEPARTMENT (EMPLOYEE_ID, NAME, DEPARTMENT_ID, MANAGER_ID, SALARY) VALUES
('E001', 'Alice', 'D001', 'M001', 60000),
('E002', 'Bob', 'D002', 'M002', 55000),
('E003', 'Charlie', 'D001', 'M001', 70000),
('E004', 'David', 'D003', 'M003', 50000),
('E005', 'Eve', 'D002', 'M002', 65000),
('E006', 'Frank', 'D003', 'M003', 48000),
('E007', 'Grace', 'D001', 'M001', 72000),
('E008', 'Heidi', 'D002', 'M002', 53000),
('E009', 'Ivan', 'D003', 'M003', 47000),
('E010', 'Judy', 'D001', 'M001', 68000);

SELECT DEPARTMENT_ID AS "Department Code",
    SUM(SALARY) AS "Total Salary"
FROM DEPARTMENT
WHERE MANAGER_ID = 'M001'
GROUP BY DEPARTMENT_ID;

SELECT DEPARTMENT_ID, COUNT(*) AS "Number of Employees"
FROM DEPARTMENT
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) > 2;